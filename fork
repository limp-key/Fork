#!/bin/bash

if [ $# == 0 ]
then
    echo
    echo 'Base'
    echo '--clear                 - remove fork test files'
    echo '--create {Type} {Name}  - create Controller or Model or Route file'
    echo '--install               - install all packate and programme for Fork'
    echo '--migration             - migration in database'
    echo
    echo 'Module'
    echo '--module           - show all module in Fork'
    echo '--include {Module} - include module in Fork'
    echo '--disable {Module} - disable module in Fork'
    exit;
fi

if [ $1 == '--clear' ]
then
    rm README.md
    rm Fork.conf
    rm controllers/ForkController.php
    rm models/ForkModel.php
    rm route/ForkRoute.php
    rm config/ForkConfig.php
    rm views/index.fork.html.php

elif [ $1 == '--create' ] && [ $2 != '' ] && [ $3 != '' ]
then
    if  [ $2 == '-controller' ] 
    then
	cp bin/Modules/Routine/Controller/Controller.php controllers/
	mv controllers/Controller.php controllers/$3.php 
	sed -i "s/__Name__/$3/" controllers/$3.php
    elif [ $2 == '-model' ] 
    then
	cp bin/Modules/Routine/Model/Model.php models/
	mv models/Model.php models/$3.php
	sed -i "s/__Name__/$3/" models/$3.php
    elif [ $2 == '-route' ]
    then
	cp bin/Modules/Routine/Route/Route.php route/
	mv route/Route.php route/$3.php
	sed -i "s/__Name__/$3/" route/$3.php
    elif [ $2 == '-config' ]
    then
	mkdir config/$3
	cp bin/Modules/Routine/Config/DataBase.Config.php config/$3
	cp bin/Modules/Routine/Config/Mail.Config.php config/$3
	cp bin/Modules/Routine/Config/Main.Config.php config/$3
	cp bin/Modules/Routine/Config/System.Config.php config/$3
    else 
	echo "Invalid create type"
    fi
elif [ $1 == '--install' ]
then
    echo 'php'
elif [ $1 == '--migration' ]
then
    echo 'php'
elif [ $1 == '--modules' ]
then
    echo
    echo 'Fork modules:'
    find bin/Modules -mindepth 1 -maxdepth 1 -type d  \( ! -iname ".*" \) | sed "s/bin\/Modules\/#/[Disable$] /" | sed "s/bin\/Modules\//[Enable]  /"
    echo
elif [ $1 == '--enable' ]
then
    if [ $2 != '' ]
    then
	mv bin/Modules/#$2 bin/Modules/$2
    else
	echo 'Invalid module name'
    fi
elif [ $1 == '--disable' ]
then
    if [ $2 != '' ]
    then
	mv bin/Modules/$2 bin/Modules/#$2
    else
	echo 'Invalid module name'
    fi
else
    echo 'Invalid command'
fi
